data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert CreateTableOne output to clean dataframe ---------------------
# Convert as before
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# Move rownames to Characteristic column
table1_df$Characteristic <- rownames(table1_df)
rownames(table1_df) <- NULL
# Remove the "test" column (the empty NA column)
table1_df <- table1_df[, !(names(table1_df) %in% c("test"))]
# Reorder so Characteristic comes first
table1_df <- table1_df[, c("Characteristic", setdiff(names(table1_df), "Characteristic"))]
# Rename columns EXACTLY to correct meaning
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
kable(table1_df,
caption = "Table 1. Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE) %>%
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%). P-values are derived from t-tests or Chi-square tests as appropriate. Effect Size = Standardized Mean Difference (SMD). ACEs = Adverse Childhood Experiences; CESDR = Center for Epidemiologic Studies Depression Scale; SABCS = Suicidal Affect–Behavior–Cognition Scale.",
general_title = "Note:",
threeparttable = TRUE
)
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
kable(table1_df,
caption = "Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
longtable = TRUE,     # <– GIỮ BẢNG QUA TRANG MỀM MẠI
align = "lccccc") %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position", "scale_down")) %>%
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%). P-values are derived from t-tests or Chi-square tests as appropriate. Effect Size = Standardized Mean Difference (SMD). ACEs = Adverse Childhood Experiences; CESDR = Center for Epidemiologic Studies Depression Scale; SABCS = Suicidal Affect–Behavior–Cognition Scale.",
general_title = "Note:",
threeparttable = TRUE
)
## Set global CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))
## Install the tableone package
install.packages("tableone")
## Load the required packages
library(tableone)
library(readxl)
library(dplyr)
library(janitor)
library(knitr)
# 1. Import dataset --------------------------------------------------------
setwd("C:/Users/Thang/OneDrive/Documents/ActivityData_Assignment/Activity_3")
data <- read_excel("SuicideRisk_Data.xlsx")
# 2. Inspect initial structure --------------------------------------------
str(data)
# 3. Convert variables to correct types -----------------------------------
data$RECORD_ID <- as.integer(data$RECORD_ID)
data$AGE <- as.numeric(data$AGE)
data$CESDR_TOTAL_SUM <- as.numeric(data$CESDR_TOTAL_SUM)
data$SABCS_TOTAL_SUM <- as.numeric(data$SABCS_TOTAL_SUM)
# Categorical variables
data$GENDER <- factor(data$GENDER, levels = c("Female", "Male"))
data$RACE <- factor(data$RACE, levels = c("White/Caucasian", "Asian", "Other"))
data$ETHNICITY <- factor(data$ETHNICITY,
levels = c("Hispanic/Latino", "Not Hispanic/Latino"))
data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert CreateTableOne output to clean dataframe ---------------------
# Convert as before
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# Move rownames to Characteristic column
table1_df$Characteristic <- rownames(table1_df)
rownames(table1_df) <- NULL
# Remove the "test" column (the empty NA column)
table1_df <- table1_df[, !(names(table1_df) %in% c("test"))]
# Reorder so Characteristic comes first
table1_df <- table1_df[, c("Characteristic", setdiff(names(table1_df), "Characteristic"))]
# Rename columns EXACTLY to correct meaning
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
cat("\\begin{adjustbox}{max width=\\textwidth}\n")
kable(table1_df,
caption = "Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
longtable = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position")) %>%
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%).",
general_title = "Note:",
threeparttable = TRUE
)
## Set global CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))
## Install the tableone package
install.packages("tableone")
## Load the required packages
library(tableone)
library(readxl)
library(dplyr)
library(janitor)
library(knitr)
# 1. Import dataset --------------------------------------------------------
setwd("C:/Users/Thang/OneDrive/Documents/ActivityData_Assignment/Activity_3")
data <- read_excel("SuicideRisk_Data.xlsx")
# 2. Inspect initial structure --------------------------------------------
str(data)
# 3. Convert variables to correct types -----------------------------------
data$RECORD_ID <- as.integer(data$RECORD_ID)
data$AGE <- as.numeric(data$AGE)
data$CESDR_TOTAL_SUM <- as.numeric(data$CESDR_TOTAL_SUM)
data$SABCS_TOTAL_SUM <- as.numeric(data$SABCS_TOTAL_SUM)
# Categorical variables
data$GENDER <- factor(data$GENDER, levels = c("Female", "Male"))
data$RACE <- factor(data$RACE, levels = c("White/Caucasian", "Asian", "Other"))
data$ETHNICITY <- factor(data$ETHNICITY,
levels = c("Hispanic/Latino", "Not Hispanic/Latino"))
data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert CreateTableOne output to clean dataframe ---------------------
# Convert as before
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# Move rownames to Characteristic column
table1_df$Characteristic <- rownames(table1_df)
rownames(table1_df) <- NULL
# Remove the "test" column (the empty NA column)
table1_df <- table1_df[, !(names(table1_df) %in% c("test"))]
# Reorder so Characteristic comes first
table1_df <- table1_df[, c("Characteristic", setdiff(names(table1_df), "Characteristic"))]
# Rename columns EXACTLY to correct meaning
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
library(kableExtra)
kable(table1_df,
caption = "Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
longtable = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position", "scale_down")) %>%
column_spec(1, width = "5cm") %>%   # Characteristic
column_spec(2, width = "3cm") %>%   # Total
column_spec(3, width = "3cm") %>%   # History
column_spec(4, width = "3cm") %>%   # No history
column_spec(5, width = "2cm") %>%   # P-value
column_spec(6, width = "2cm") %>%   # Effect size
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%).",
general_title = "Note:",
threeparttable = TRUE
)
knitr::opts_chunk$set(echo = TRUE)
## Set global CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))
## Install the tableone package
install.packages("tableone")
## Load the required packages
library(tableone)
library(readxl)
library(dplyr)
library(janitor)
library(knitr)
# 1. Import dataset --------------------------------------------------------
setwd("C:/Users/Thang/OneDrive/Documents/ActivityData_Assignment/Activity_3")
data <- read_excel("SuicideRisk_Data.xlsx")
# 2. Inspect initial structure --------------------------------------------
str(data)
# 3. Convert variables to correct types -----------------------------------
data$RECORD_ID <- as.integer(data$RECORD_ID)
data$AGE <- as.numeric(data$AGE)
data$CESDR_TOTAL_SUM <- as.numeric(data$CESDR_TOTAL_SUM)
data$SABCS_TOTAL_SUM <- as.numeric(data$SABCS_TOTAL_SUM)
# Categorical variables
data$GENDER <- factor(data$GENDER, levels = c("Female", "Male"))
data$RACE <- factor(data$RACE, levels = c("White/Caucasian", "Asian", "Other"))
data$ETHNICITY <- factor(data$ETHNICITY,
levels = c("Hispanic/Latino", "Not Hispanic/Latino"))
data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert CreateTableOne output to clean dataframe ---------------------
# Convert as before
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# Move rownames to Characteristic column
table1_df$Characteristic <- rownames(table1_df)
rownames(table1_df) <- NULL
# Remove the "test" column (the empty NA column)
table1_df <- table1_df[, !(names(table1_df) %in% c("test"))]
# Reorder so Characteristic comes first
table1_df <- table1_df[, c("Characteristic", setdiff(names(table1_df), "Characteristic"))]
# Rename columns EXACTLY to correct meaning
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
library(kableExtra)
kable(table1_df,
caption = "Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
longtable = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position", "scale_down")) %>%
column_spec(1, width = "5cm") %>%   # Characteristic
column_spec(2, width = "3cm") %>%   # Total
column_spec(3, width = "3cm") %>%   # History
column_spec(4, width = "3cm") %>%   # No history
column_spec(5, width = "2cm") %>%   # P-value
column_spec(6, width = "2cm") %>%   # Effect size
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%).",
general_title = "Note:",
threeparttable = TRUE
)
## Set global CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))
## Install the tableone package
install.packages("tableone")
## Load the required packages
library(tableone)
library(readxl)
library(dplyr)
library(janitor)
library(knitr)
# 1. Import dataset --------------------------------------------------------
setwd("C:/Users/Thang/OneDrive/Documents/ActivityData_Assignment/Activity_3")
data <- read_excel("SuicideRisk_Data.xlsx")
# 2. Inspect initial structure --------------------------------------------
str(data)
# 3. Convert variables to correct types -----------------------------------
data$RECORD_ID <- as.integer(data$RECORD_ID)
data$AGE <- as.numeric(data$AGE)
data$CESDR_TOTAL_SUM <- as.numeric(data$CESDR_TOTAL_SUM)
data$SABCS_TOTAL_SUM <- as.numeric(data$SABCS_TOTAL_SUM)
# Categorical variables
data$GENDER <- factor(data$GENDER, levels = c("Female", "Male"))
data$RACE <- factor(data$RACE, levels = c("White/Caucasian", "Asian", "Other"))
data$ETHNICITY <- factor(data$ETHNICITY,
levels = c("Hispanic/Latino", "Not Hispanic/Latino"))
data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert CreateTableOne output to clean dataframe ---------------------
# Convert as before
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# Move rownames to Characteristic column
table1_df$Characteristic <- rownames(table1_df)
rownames(table1_df) <- NULL
# Remove the "test" column (the empty NA column)
table1_df <- table1_df[, !(names(table1_df) %in% c("test"))]
# Reorder so Characteristic comes first
table1_df <- table1_df[, c("Characteristic", setdiff(names(table1_df), "Characteristic"))]
# Rename columns EXACTLY to correct meaning
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
kable(table1_df,
caption = "Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position", "scale_down")) %>%
column_spec(1, width = "4cm") %>%
column_spec(2, width = "3cm") %>%
column_spec(3, width = "3cm") %>%
column_spec(4, width = "3cm") %>%
column_spec(5, width = "2cm") %>%
column_spec(6, width = "2cm") %>%
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%). P-values are derived from t-tests or Chi-square tests.",
general_title = "Note:",
threeparttable = TRUE
)
knitr::opts_chunk$set(echo = TRUE)
## Set global CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))
## Install the tableone package
install.packages("tableone")
## Load the required packages
library(tableone)
library(readxl)
library(dplyr)
library(janitor)
library(knitr)
# 1. Import dataset --------------------------------------------------------
setwd("C:/Users/Thang/OneDrive/Documents/ActivityData_Assignment/Activity_3")
data <- read_excel("SuicideRisk_Data.xlsx")
# 2. Inspect initial structure --------------------------------------------
str(data)
# 3. Convert variables to correct types -----------------------------------
data$RECORD_ID <- as.integer(data$RECORD_ID)
data$AGE <- as.numeric(data$AGE)
data$CESDR_TOTAL_SUM <- as.numeric(data$CESDR_TOTAL_SUM)
data$SABCS_TOTAL_SUM <- as.numeric(data$SABCS_TOTAL_SUM)
# Categorical variables
data$GENDER <- factor(data$GENDER, levels = c("Female", "Male"))
data$RACE <- factor(data$RACE, levels = c("White/Caucasian", "Asian", "Other"))
data$ETHNICITY <- factor(data$ETHNICITY,
levels = c("Hispanic/Latino", "Not Hispanic/Latino"))
data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert CreateTableOne output to clean dataframe ---------------------
# Convert as before
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# Move rownames to Characteristic column
table1_df$Characteristic <- rownames(table1_df)
rownames(table1_df) <- NULL
# Remove the "test" column (the empty NA column)
table1_df <- table1_df[, !(names(table1_df) %in% c("test"))]
# Reorder so Characteristic comes first
table1_df <- table1_df[, c("Characteristic", setdiff(names(table1_df), "Characteristic"))]
# Rename columns EXACTLY to correct meaning
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
kable(table1_df,
caption = "Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position", "scale_down")) %>%
column_spec(1, width = "4cm") %>%
column_spec(2, width = "3cm") %>%
column_spec(3, width = "3cm") %>%
column_spec(4, width = "3cm") %>%
column_spec(5, width = "2cm") %>%
column_spec(6, width = "2cm") %>%
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%). P-values are derived from t-tests or Chi-square tests.",
general_title = "Note:",
threeparttable = TRUE
)
