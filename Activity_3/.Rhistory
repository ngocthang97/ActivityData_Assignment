library(dplyr)
install.packages("psych")
library(psych)
# 1. Descriptive statistics by race
data %>%
group_by(RACE) %>%
summarise(
n = n(),
mean_SABCS = mean(SABCS_TOTAL_SUM, na.rm = TRUE),
sd_SABCS = sd(SABCS_TOTAL_SUM, na.rm = TRUE),
median_SABCS = median(SABCS_TOTAL_SUM, na.rm = TRUE),
IQR_SABCS = IQR(SABCS_TOTAL_SUM, na.rm = TRUE)
)
# 2. Visualization: Boxplot of SABCS by Race
ggplot(data, aes(x = RACE, y = SABCS_TOTAL_SUM, fill = RACE)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.4) +
theme_minimal() +
labs(title = "Distribution of Suicidal Risk (SABCS) Across Race Groups",
x = "Race Group", y = "SABCS Total Score") +
theme(legend.position = "none")
# 3. Run one-way ANOVA
anova_model <- aov(SABCS_TOTAL_SUM ~ RACE, data = data)
summary(anova_model)
# Check homogeneity of variances (Levene’s test)
install.packages("car")
library(car)
leveneTest(SABCS_TOTAL_SUM ~ RACE, data = data)
# Check normality of residuals
shapiro.test(residuals(anova_model))
# Visualization of residuals
par(mfrow = c(1, 2))
plot(anova_model, which = 1)  # Residuals vs Fitted
plot(anova_model, which = 2)  # Q-Q plot
par(mfrow = c(1, 1))
knitr::opts_chunk$set(echo = TRUE)
# Make sure reference category is White/Caucasian
data$RACE <- relevel(data$RACE, ref = "White/Caucasian")
# Fit the linear regression model
lm_model <- lm(SABCS_TOTAL_SUM ~ RACE, data = data)
# Show summary
summary(lm_model)
# A. Group comparison for INCOME
library(dplyr)
library(ggplot2)
# 1. Summary stats by INCOME
income_summary <- data %>%
group_by(INCOME) %>%
summarise(
n = n(),
mean_SABCS = mean(SABCS_TOTAL_SUM, na.rm = TRUE),
sd_SABCS = sd(SABCS_TOTAL_SUM, na.rm = TRUE),
median_SABCS = median(SABCS_TOTAL_SUM, na.rm = TRUE),
IQR_SABCS = IQR(SABCS_TOTAL_SUM, na.rm = TRUE)
)
income_summary
# 2. Visualization
ggplot(data, aes(x = INCOME, y = SABCS_TOTAL_SUM, fill = INCOME)) +
geom_boxplot() +
geom_jitter(width = 0.15, alpha = 0.4) +
theme_minimal() +
labs(
title = "Distribution of Suicidal Risk (SABCS) Across Income Groups",
x = "Income Group",
y = "SABCS Total Score"
) +
theme(legend.position = "none")
# 3. One-way ANOVA
anova_income <- aov(SABCS_TOTAL_SUM ~ INCOME, data = data)
summary(anova_income)
# Levene test
library(car)
leveneTest(SABCS_TOTAL_SUM ~ INCOME, data = data)
# Shapiro–Wilk for residuals
shapiro.test(residuals(anova_income))
# Residual plots
par(mfrow = c(1, 2))
plot(anova_income, which = 1)  # Residuals vs Fitted
plot(anova_income, which = 2)  # QQ plot
par(mfrow = c(1, 1))
library(ggplot2)
ggplot(data, aes(x = CESDR_TOTAL_SUM, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Relationship Between Depression (CESD-R) and Suicidal Risk (SABCS)",
x = "Depression (CESD-R Total Score)",
y = "Suicidal Risk (SABCS Total Score)"
)
cor_test <- cor.test(data$SABCS_TOTAL_SUM, data$CESDR_TOTAL_SUM, method = "pearson")
cor_test
# Check linearity visually
plot(data$CESDR_TOTAL_SUM, data$SABCS_TOTAL_SUM,
main = "Scatterplot to Assess Linearity",
xlab = "Depression (CESD-R)", ylab = "Suicidal Risk (SABCS)")
abline(lm(SABCS_TOTAL_SUM ~ CESDR_TOTAL_SUM, data = data), col = "red")
# Check normality of both variables
shapiro.test(data$CESDR_TOTAL_SUM)
shapiro.test(data$SABCS_TOTAL_SUM)
## ---- Linear Regression: Depression predicting Suicidal Risk ----
# Fit simple linear regression model
lm_line <- lm(SABCS_TOTAL_SUM ~ CESDR_TOTAL_SUM, data = data)
# Display summary of regression results
summary(lm_line)
#  Visualization: scatterplot + regression line
library(ggplot2)
ggplot(data, aes(x = CESDR_TOTAL_SUM, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Linear Relationship Between Depression (CESD-R) and Suicidal Risk (SABCS)",
x = "Depression (CESD-R Total Score)",
y = "Suicidal Risk (SABCS Total Score)"
)
#  Extract regression coefficients for equation
coef(lm_line)
# (optional) store intercept and slope for display
intercept <- coef(lm_line)[1]
slope <- coef(lm_line)[2]
cat("Estimated regression equation:\nSABCS =", round(intercept, 2),
"+", round(slope, 2), "× CESD-R\n")
# Calculate R-squared manually (for reporting)
r_squared <- summary(lm_line)$r.squared
cat("R-squared:", round(r_squared, 3), "\n")
# Scatterplot of Age vs. Suicidal Risk
ggplot(data, aes(x = AGE, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Relationship Between Age and Suicidal Risk (SABCS)",
x = "Age (years)",
y = "Suicidal Risk (SABCS Total Score)"
)
# Pearson correlation between suicidal risk and age
cor_age <- cor.test(data$SABCS_TOTAL_SUM, data$AGE, method = "pearson")
cor_age
# Check linearity visually (scatterplot above)
# Check normality of both variables
shapiro.test(data$AGE)
shapiro.test(data$SABCS_TOTAL_SUM)
lm_age <- lm(SABCS_TOTAL_SUM ~ AGE, data = data)
summary(lm_age)
knitr::opts_chunk$set(echo = TRUE)
## Set global CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))
## Install the tableone package
install.packages("tableone")
## Load the required packages
library(tableone)
library(readxl)
library(dplyr)
library(janitor)
library(knitr)
# 1. Import dataset --------------------------------------------------------
setwd("C:/Users/Thang/OneDrive/Documents/ActivityData_Assignment/Activity_3")
data <- read_excel("SuicideRisk_Data.xlsx")
# 2. Inspect initial structure --------------------------------------------
str(data)
# 3. Convert variables to correct types -----------------------------------
data$RECORD_ID <- as.integer(data$RECORD_ID)
data$AGE <- as.numeric(data$AGE)
data$CESDR_TOTAL_SUM <- as.numeric(data$CESDR_TOTAL_SUM)
data$SABCS_TOTAL_SUM <- as.numeric(data$SABCS_TOTAL_SUM)
# Categorical variables
data$GENDER <- factor(data$GENDER, levels = c("Female", "Male"))
data$RACE <- factor(data$RACE, levels = c("White/Caucasian", "Asian", "Other"))
data$ETHNICITY <- factor(data$ETHNICITY,
levels = c("Hispanic/Latino", "Not Hispanic/Latino"))
data$INCOME <- factor(data$INCOME,
levels = c("<$30,000", "$30,000 - $50,000",
"$51,000 - $75,000", "$76,000 - $100,000",
">$100,000"))
# Binary ACEs
aces_vars <- paste0("ACES___", 1:10)
data[aces_vars] <- lapply(data[aces_vars], factor,
levels = c(0, 1), labels = c("No", "Yes"))
# Suicide history variable (must exist before CreateTableOne)
data$HX_SUICIDE <- factor(data$HX_SUICIDE,
levels = c(1, 0),
labels = c("History of Suicide", "No History of Suicide"))
# Confirm it exists
table(data$HX_SUICIDE)
# 4. Define variables for Table 1 -----------------------------------------
vars <- c("AGE", "GENDER", "RACE", "ETHNICITY", "INCOME",
aces_vars, "CESDR_TOTAL_SUM", "SABCS_TOTAL_SUM")
catVars <- c("GENDER", "RACE", "ETHNICITY", "INCOME", aces_vars)
# 5. Create Table 1 --------------------------------------------------------
table1 <- CreateTableOne(
vars = vars,
strata = "HX_SUICIDE",
data = data,
factorVars = catVars,
addOverall = TRUE,
test = TRUE
)
# 6. Convert to data frame -------------------------------------------------
table1_df <- as.data.frame(print(table1, test = TRUE, smd = TRUE))
# 7. Rename and reorder columns -------------------------------------------
names(table1_df) <- c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"P-value",
"Effect Size")
table1_df <- table1_df[, c("Characteristic",
"Total (n = 546)",
"History of Suicide",
"No History of Suicide",
"Effect Size",
"P-value")]
# 8. Display nicely --------------------------------------------------------
library(kableExtra)
kable(table1_df,
caption = "Table 1. Demographic and Mental Health Characteristics (n = 546)",
booktabs = TRUE,
align = "lccccc") %>%
kable_styling(full_width = FALSE) %>%
footnote(
general = "Continuous variables are shown as mean ± SD; categorical variables as n (%). P-values are derived from t-tests or Chi-square tests as appropriate. Effect Size = Standardized Mean Difference (SMD). ACEs = Adverse Childhood Experiences; CESDR = Center for Epidemiologic Studies Depression Scale; SABCS = Suicidal Affect–Behavior–Cognition Scale.",
general_title = "Note:",
threeparttable = TRUE
)
# Load necessary packages
library(ggplot2)
library(dplyr)
install.packages("psych")
library(psych)
# 1. Descriptive statistics by race
data %>%
group_by(RACE) %>%
summarise(
n = n(),
mean_SABCS = mean(SABCS_TOTAL_SUM, na.rm = TRUE),
sd_SABCS = sd(SABCS_TOTAL_SUM, na.rm = TRUE),
median_SABCS = median(SABCS_TOTAL_SUM, na.rm = TRUE),
IQR_SABCS = IQR(SABCS_TOTAL_SUM, na.rm = TRUE)
)
# 2. Visualization: Boxplot of SABCS by Race
ggplot(data, aes(x = RACE, y = SABCS_TOTAL_SUM, fill = RACE)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.4) +
theme_minimal() +
labs(title = "Distribution of Suicidal Risk (SABCS) Across Race Groups",
x = "Race Group", y = "SABCS Total Score") +
theme(legend.position = "none")
# 3. Run one-way ANOVA
anova_model <- aov(SABCS_TOTAL_SUM ~ RACE, data = data)
summary(anova_model)
# Check homogeneity of variances (Levene’s test)
install.packages("car")
library(car)
leveneTest(SABCS_TOTAL_SUM ~ RACE, data = data)
# Check normality of residuals
shapiro.test(residuals(anova_model))
# Visualization of residuals
par(mfrow = c(1, 2))
plot(anova_model, which = 1)  # Residuals vs Fitted
plot(anova_model, which = 2)  # Q-Q plot
par(mfrow = c(1, 1))
# Make sure reference category is White/Caucasian
data$RACE <- relevel(data$RACE, ref = "White/Caucasian")
# Fit the linear regression model
lm_model <- lm(SABCS_TOTAL_SUM ~ RACE, data = data)
# Show summary
summary(lm_model)
# A. Group comparison for INCOME
library(dplyr)
library(ggplot2)
# 1. Summary stats by INCOME
income_summary <- data %>%
group_by(INCOME) %>%
summarise(
n = n(),
mean_SABCS = mean(SABCS_TOTAL_SUM, na.rm = TRUE),
sd_SABCS = sd(SABCS_TOTAL_SUM, na.rm = TRUE),
median_SABCS = median(SABCS_TOTAL_SUM, na.rm = TRUE),
IQR_SABCS = IQR(SABCS_TOTAL_SUM, na.rm = TRUE)
)
income_summary
# 2. Visualization
ggplot(data, aes(x = INCOME, y = SABCS_TOTAL_SUM, fill = INCOME)) +
geom_boxplot() +
geom_jitter(width = 0.15, alpha = 0.4) +
theme_minimal() +
labs(
title = "Distribution of Suicidal Risk (SABCS) Across Income Groups",
x = "Income Group",
y = "SABCS Total Score"
) +
theme(legend.position = "none")
# 3. One-way ANOVA
anova_income <- aov(SABCS_TOTAL_SUM ~ INCOME, data = data)
summary(anova_income)
# Levene test
library(car)
leveneTest(SABCS_TOTAL_SUM ~ INCOME, data = data)
# Shapiro–Wilk for residuals
shapiro.test(residuals(anova_income))
# Residual plots
par(mfrow = c(1, 2))
plot(anova_income, which = 1)  # Residuals vs Fitted
plot(anova_income, which = 2)  # QQ plot
par(mfrow = c(1, 1))
# Check group sizes and means
table(data$GENDER)
tapply(data$SABCS_TOTAL_SUM, data$GENDER, mean, na.rm = TRUE)
tapply(data$SABCS_TOTAL_SUM, data$GENDER, sd, na.rm = TRUE)
# Perform independent samples t-test
t_test_gender <- t.test(SABCS_TOTAL_SUM ~ GENDER, data = data, var.equal = TRUE)
t_test_gender
data$GENDER <- relevel(data$GENDER, ref = "Female")
lm_gender <- lm(SABCS_TOTAL_SUM ~ GENDER, data = data)
summary(lm_gender)
library(ggplot2)
ggplot(data, aes(x = CESDR_TOTAL_SUM, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Relationship Between Depression (CESD-R) and Suicidal Risk (SABCS)",
x = "Depression (CESD-R Total Score)",
y = "Suicidal Risk (SABCS Total Score)"
)
cor_test <- cor.test(data$SABCS_TOTAL_SUM, data$CESDR_TOTAL_SUM, method = "pearson")
cor_test
# Check linearity visually
plot(data$CESDR_TOTAL_SUM, data$SABCS_TOTAL_SUM,
main = "Scatterplot to Assess Linearity",
xlab = "Depression (CESD-R)", ylab = "Suicidal Risk (SABCS)")
abline(lm(SABCS_TOTAL_SUM ~ CESDR_TOTAL_SUM, data = data), col = "red")
# Check normality of both variables
shapiro.test(data$CESDR_TOTAL_SUM)
shapiro.test(data$SABCS_TOTAL_SUM)
## ---- Linear Regression: Depression predicting Suicidal Risk ----
# Fit simple linear regression model
lm_line <- lm(SABCS_TOTAL_SUM ~ CESDR_TOTAL_SUM, data = data)
# Display summary of regression results
summary(lm_line)
#  Visualization: scatterplot + regression line
library(ggplot2)
ggplot(data, aes(x = CESDR_TOTAL_SUM, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Linear Relationship Between Depression (CESD-R) and Suicidal Risk (SABCS)",
x = "Depression (CESD-R Total Score)",
y = "Suicidal Risk (SABCS Total Score)"
)
#  Extract regression coefficients for equation
coef(lm_line)
# (optional) store intercept and slope for display
intercept <- coef(lm_line)[1]
slope <- coef(lm_line)[2]
cat("Estimated regression equation:\nSABCS =", round(intercept, 2),
"+", round(slope, 2), "× CESD-R\n")
# Calculate R-squared manually (for reporting)
r_squared <- summary(lm_line)$r.squared
cat("R-squared:", round(r_squared, 3), "\n")
# Scatterplot of Age vs. Suicidal Risk
ggplot(data, aes(x = AGE, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Relationship Between Age and Suicidal Risk (SABCS)",
x = "Age (years)",
y = "Suicidal Risk (SABCS Total Score)"
)
# Pearson correlation between suicidal risk and age
cor_age <- cor.test(data$SABCS_TOTAL_SUM, data$AGE, method = "pearson")
cor_age
# Check linearity visually (scatterplot above)
# Check normality of both variables
shapiro.test(data$AGE)
shapiro.test(data$SABCS_TOTAL_SUM)
lm_age <- lm(SABCS_TOTAL_SUM ~ AGE, data = data)
summary(lm_age)
knitr::opts_chunk$set(echo = TRUE)
# Check homogeneity of variances (Levene’s test)
install.packages("car")
library(car)
leveneTest(SABCS_TOTAL_SUM ~ RACE, data = data)
# Check normality of residuals
shapiro.test(residuals(anova_model))
# Visualization of residuals
par(mfrow = c(1, 2))
plot(anova_model, which = 1)  # Residuals vs Fitted
plot(anova_model, which = 2)  # Q-Q plot
par(mfrow = c(1, 1))
# Make sure reference category is White/Caucasian
data$RACE <- relevel(data$RACE, ref = "White/Caucasian")
# Fit the linear regression model
lm_model <- lm(SABCS_TOTAL_SUM ~ RACE, data = data)
# Show summary
summary(lm_model)
# A. Group comparison for INCOME
library(dplyr)
library(ggplot2)
# 1. Summary stats by INCOME
income_summary <- data %>%
group_by(INCOME) %>%
summarise(
n = n(),
mean_SABCS = mean(SABCS_TOTAL_SUM, na.rm = TRUE),
sd_SABCS = sd(SABCS_TOTAL_SUM, na.rm = TRUE),
median_SABCS = median(SABCS_TOTAL_SUM, na.rm = TRUE),
IQR_SABCS = IQR(SABCS_TOTAL_SUM, na.rm = TRUE)
)
income_summary
# 2. Visualization
ggplot(data, aes(x = INCOME, y = SABCS_TOTAL_SUM, fill = INCOME)) +
geom_boxplot() +
geom_jitter(width = 0.15, alpha = 0.4) +
theme_minimal() +
labs(
title = "Distribution of Suicidal Risk (SABCS) Across Income Groups",
x = "Income Group",
y = "SABCS Total Score"
) +
theme(legend.position = "none")
# 3. One-way ANOVA
anova_income <- aov(SABCS_TOTAL_SUM ~ INCOME, data = data)
summary(anova_income)
# Levene test
library(car)
leveneTest(SABCS_TOTAL_SUM ~ INCOME, data = data)
# Shapiro–Wilk for residuals
shapiro.test(residuals(anova_income))
# Residual plots
par(mfrow = c(1, 2))
plot(anova_income, which = 1)  # Residuals vs Fitted
plot(anova_income, which = 2)  # QQ plot
par(mfrow = c(1, 1))
# Check group sizes and means
table(data$GENDER)
tapply(data$SABCS_TOTAL_SUM, data$GENDER, mean, na.rm = TRUE)
tapply(data$SABCS_TOTAL_SUM, data$GENDER, sd, na.rm = TRUE)
# Perform independent samples t-test
t_test_gender <- t.test(SABCS_TOTAL_SUM ~ GENDER, data = data, var.equal = TRUE)
t_test_gender
data$GENDER <- relevel(data$GENDER, ref = "Female")
lm_gender <- lm(SABCS_TOTAL_SUM ~ GENDER, data = data)
summary(lm_gender)
library(ggplot2)
ggplot(data, aes(x = CESDR_TOTAL_SUM, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Relationship Between Depression (CESD-R) and Suicidal Risk (SABCS)",
x = "Depression (CESD-R Total Score)",
y = "Suicidal Risk (SABCS Total Score)"
)
cor_test <- cor.test(data$SABCS_TOTAL_SUM, data$CESDR_TOTAL_SUM, method = "pearson")
cor_test
# Check linearity visually
plot(data$CESDR_TOTAL_SUM, data$SABCS_TOTAL_SUM,
main = "Scatterplot to Assess Linearity",
xlab = "Depression (CESD-R)", ylab = "Suicidal Risk (SABCS)")
abline(lm(SABCS_TOTAL_SUM ~ CESDR_TOTAL_SUM, data = data), col = "red")
# Check normality of both variables
shapiro.test(data$CESDR_TOTAL_SUM)
shapiro.test(data$SABCS_TOTAL_SUM)
## ---- Linear Regression: Depression predicting Suicidal Risk ----
# Fit simple linear regression model
lm_line <- lm(SABCS_TOTAL_SUM ~ CESDR_TOTAL_SUM, data = data)
# Display summary of regression results
summary(lm_line)
#  Visualization: scatterplot + regression line
library(ggplot2)
ggplot(data, aes(x = CESDR_TOTAL_SUM, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Linear Relationship Between Depression (CESD-R) and Suicidal Risk (SABCS)",
x = "Depression (CESD-R Total Score)",
y = "Suicidal Risk (SABCS Total Score)"
)
#  Extract regression coefficients for equation
coef(lm_line)
# (optional) store intercept and slope for display
intercept <- coef(lm_line)[1]
slope <- coef(lm_line)[2]
cat("Estimated regression equation:\nSABCS =", round(intercept, 2),
"+", round(slope, 2), "× CESD-R\n")
# Calculate R-squared manually (for reporting)
r_squared <- summary(lm_line)$r.squared
cat("R-squared:", round(r_squared, 3), "\n")
# Scatterplot of Age vs. Suicidal Risk
ggplot(data, aes(x = AGE, y = SABCS_TOTAL_SUM)) +
geom_point(alpha = 0.5, color = "#2E86AB") +
geom_smooth(method = "lm", se = TRUE, color = "#E74C3C") +
theme_minimal() +
labs(
title = "Relationship Between Age and Suicidal Risk (SABCS)",
x = "Age (years)",
y = "Suicidal Risk (SABCS Total Score)"
)
# Pearson correlation between suicidal risk and age
cor_age <- cor.test(data$SABCS_TOTAL_SUM, data$AGE, method = "pearson")
cor_age
# Check linearity visually (scatterplot above)
# Check normality of both variables
shapiro.test(data$AGE)
shapiro.test(data$SABCS_TOTAL_SUM)
lm_age <- lm(SABCS_TOTAL_SUM ~ AGE, data = data)
summary(lm_age)
